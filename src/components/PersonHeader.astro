---
import PersonHeaderLink from "./PersonHeaderLink.astro";
import PersonNameTag from "./PersonNameTag.astro";

const { familyName, name } = Astro.props;

const lowercasedName = name.toLowerCase();
const { url: currentUrl } = Astro.request;
const isOnProjects = currentUrl.includes(lowercasedName);
const isOnCV = currentUrl.includes("cv");
const isOnContact = currentUrl.includes("contact");
const isOnAbout = currentUrl.includes("about");
const reversedFlex =
  lowercasedName === "barna" ? "flex-row-reverse" : "flex-row";
---

<script>
  const currentUrl = new URL(window.location.href);
  const headerBgOnScroll = currentUrl.toString().includes("barna")
    ? "bg-[#0D1205]"
    : "bg-[#15000c]";
  window.addEventListener("scroll", () => {
    const header = document.querySelector("header");
    if (header) {
      if (window.scrollY > 0) {
        header.classList.add(headerBgOnScroll);
        header.classList.add("bg-opacity-80");
        header.classList.add("drop-shadow-md");
        header.classList.add("backdrop-blur-sm");
        header.classList.add("z-50");
      } else {
        header.classList.remove(headerBgOnScroll);
        header.classList.remove("bg-opacity-80");
        header.classList.remove("drop-shadow-md");
        header.classList.remove("backdrop-blur-sm");
        header.classList.remove("z-50");
      }
    }
  });
</script>

<header
  class={`flex justify-between ${reversedFlex} mx-auto lg:w-[90%] items-center sticky top-0 z-50 isolate`}
>
  <ul class={`flex text-[1rem] gap-[20px] pt-5`}>
    <PersonHeaderLink href="/">Home</PersonHeaderLink>
    <PersonHeaderLink href={`/${lowercasedName}`} isCurrentPage={isOnProjects}
      >Projects</PersonHeaderLink
    >
    <PersonHeaderLink href={`/${lowercasedName}/cv`} isCurrentPage={isOnCV}
      >CV</PersonHeaderLink
    >

    <PersonHeaderLink
      href={`/${lowercasedName}/contact`}
      isCurrentPage={isOnContact}>Contact</PersonHeaderLink
    >
    <PersonHeaderLink
      href={`/${lowercasedName}/about`}
      isCurrentPage={isOnAbout}>About</PersonHeaderLink
    >
  </ul>

  <PersonNameTag
    familyName={familyName.toUpperCase()}
    name={name.toUpperCase()}
  />
</header>

<style>
  header {
    transition: background-color 0.2s ease-out;
  }
</style>
